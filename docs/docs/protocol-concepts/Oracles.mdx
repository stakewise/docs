---
title: Oracles
sidebar_position: 3
---

import Admonition from '@theme/Admonition';

```mdx-code-block
import Tooltip from '@site/src/components/Tooltip/Tooltip';
```

# Oracles

## Introduction

Oracles are specialized entities that connect blockchains to external data sources, enabling smart contracts to access real-world information.

In the StakeWise protocol, Oracles monitor validator performance data on the Beacon Chain and reach consensus on validator registration approvals, reward distribution, and exit processes within Vaults.

Oracles are a crucial part of the protocol, and must remain sufficiently decentralized and maintain high uptime in order for StakeWise to work seamlessly.

The protocol operates with 11 Oracles selected and [approved ↗](https://vote.stakewise.io/#/proposal/0x54ceedefd1060fbad17ab6181be5a90da4c686dc071d1f6121d24c0398700be6)
by the StakeWise DAO through governance processes.
These Oracles form a decentralized network of independent nodes that ensures protocol resilience and prevents single points of failure.
This distributed approach eliminates centralized control, reduces regulatory capture risks, and ensures protocol longevity through consensus-based decision making.

Oracle decisions require threshold-based consensus depending on the operation.
Validator registration requires 8 out of 11 Oracle signatures, while reward updates need 6 out of 11 signatures.

Through Oracle consensus, all Vaults stay synced with the Beacon Chain, display accurate information, trigger secure and timely new validator registrations, and fulfill exit requests.
These duties are performed automatically using Oracle software developed by the StakeWise team, with no manual actions involved.

Oracles are one of the protocol’s building blocks to deliver seamless staking and unstaking experiences.

## Oracle Duties

Oracles run the [v3-oracle ↗](https://github.com/stakewise/v3-oracle) nodes and are responsible for validator registration, reward distribution, and validator exits.

### Validator Registration

Oracles approve validator registration requests before they are submitted to the Beacon Chain [Deposit Contract ↗](https://etherscan.io/address/0x00000000219ab540356cbb839cbe05303d7705fa#code).

The [v3-operator ↗](https://github.com/stakewise/v3-operator) periodically checks whether its Vaults have accumulated enough ETH for registering new validator(s).
Upon having enough ETH, the operator sends a registration approval request to Oracles that includes encrypted exit signature(s) for the validator(s) it is attempting to create.
This is done to maintain the protocol’s ability to exit validators on demand, and to perform checks against the front-running withdrawal credentials attack described [here ↗](https://blog.lido.fi/vulnerability-response-update/).
The operator must receive **8 out of 11 approvals** from Oracles to register a validator for the Vault.

Oracles approve new validator registrations through a multi-step process:

<Admonition type="tip" icon="⏳" title="Validator Registration Process">
  <ol style={{ listStyleType: "none", paddingLeft: "0" }}>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>1.</span> Operator sends the validator registration requests and encrypted exit signatures to the Oracles.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>2.</span> Oracles sign approval messages that include the current tree root hash from the Beacon Chain Deposit Contract.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>3.</span> Operator submits registration to the Vault contract with Oracle signatures.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>4.</span> Vault contract calls the [Keeper contract ↗](https://etherscan.io/address/0x6B5815467da09DaA7DC83Db21c9239d98Bb487b5#code) to validate Oracle signatures and confirm the tree root hash hasn't changed.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>5.</span> Vault transfers ETH to the Beacon Chain deposit contract to complete validator registration.</li>
  </ol>
</Admonition>

This process ensures Oracles approve validators based on current Beacon Chain state, bridging the consensus and execution layers while preventing stale approvals and replay attacks.

### Reward Distribution

Oracles periodically vote on the consensus rewards/penalties accumulated by the Vaults in the Beacon Chain and execution rewards (MEV & priority fees) for the Vaults connected to the Smoothing Pool.

The reward distribution process consists of the following steps:

<Admonition type="tip" icon="💰" title="Reward Distribution Process">
  <ol style={{ listStyleType: "none", paddingLeft: "0" }}>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>1.</span> Verify sufficient time has passed since the last reward distribution.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>2.</span> Calculate rewards/penalties for all Vaults based on validator balances in the Beacon Chain.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>3.</span> Calculate MEV and priority fee rewards for Vaults connected to the Smoothing Pool.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>4.</span> Create Merkle trees from reward calculations and upload them to IPFS. For example, <code>bafkreibqhdr6p5uh67ickt4dpppb525bwuofjocnpsx4dbl57llogfph2e</code>.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>5.</span> Save the cryptographically signed vote to the local database and expose via API.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>6.</span> The [Keeper service ↗](https://github.com/stakewise/v3-keeper/) fetches votes from Oracle APIs, concatenates them, and sends the resulting transaction to the [Keeper contract ↗](https://etherscan.io/address/0x6B5815467da09DaA7DC83Db21c9239d98Bb487b5#code).</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>7.</span> Upon verification, the protocol updates global state.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>8.</span> Individual Vaults can claim their rewards.</li>
  </ol>
</Admonition>

The reward update process has protocol-wide impact.

### Validator Exits

The validator exit process is automated and trustless.
The exit signatures submitted to Oracles upon validator registration are encrypted and secured through distributed key management and can be reconstructed independently when needed.

<Admonition type="tip" icon="🔑" title="Validator Exit Registration Process">
  <ol style={{ listStyleType: "none", paddingLeft: "0" }}>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>1.</span> Operator generates the BLS exit signature<sup><a href="#user-content-fn-1" id="user-content-fnref-1" style={{textDecoration: 'none'}}>1</a></sup> of the validator using local keystores or a remote signer.</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>2.</span> Operator shares the exit signature of the validator with StakeWise Oracles:</li>
    <ul style={{ listStyleType: "disc", paddingLeft: "80px" }}>
      <li>Using Shamir's secret sharing, splits validator's BLS signature<sup><a href="#user-content-fn-2" id="user-content-fnref-2" style={{textDecoration: 'none'}}>2</a></sup>. The number of shares equals the number of oracles.</li>
      <li>Encrypts exit signatures with the oracles' public keys.</li>
      <li>Sends encrypted exit signatures to all the oracles and receives registration signatures from them.</li>
    </ul>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>3.</span> Sends transaction to the Vault contract to register the validator.</li>
  </ol>
</Admonition>

Without Oracle approval of the exit signatures, the validator registration cannot proceed.

## Oracle Network Participants

<Admonition type="tip" icon="🔮" title="Oracle Network Participants">
  <ol style={{ listStyleType: "none", paddingLeft: "0" }}>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>1.</span> Chorus One</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>2.</span> Stake.fish</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>3.</span> Telekom (formerly T-Systems MMS)</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>4.</span> Finoa Consensus Services</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>5.</span> Bitfly (operators of the Beaconchain explorer)</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>6.</span> SenseiNode</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>7.</span> Gateway.fm</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>8.</span> Gnosis Chain team</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>9.</span> P2P</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>10.</span> DSRV</li>
    <li><span style={{ display: "inline-block", width: "3ch", textAlign: "left" }}>11.</span> StakeWise Labs (the development team)</li>
  </ol>
</Admonition>

<div id="user-content-fn-1" style={{fontSize: '0.85em', color: '#6b7280', marginTop: '2rem', listStyle: 'none', fontFamily: 'Fragment Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace'}}>
  <span>1.</span>
  Validators in Ethereum use two sets of BLS keys: <strong>validator keys (hot)</strong> and <strong>withdrawal keys (cold)</strong>. Validator keys sign attestations, blocks, and exits (`SignedVoluntaryExit`), while withdrawal keys secure the eventual withdrawal of stake and rewards.
  <a href="#user-content-fnref-1" style={{color: '#6b7280', textDecoration: 'none'}}>↩</a>
</div>

<div id="user-content-fn-2" style={{fontSize: '0.85em', color: '#6b7280', marginTop: '2rem', listStyle: 'none', fontFamily: 'Fragment Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace'}}>
  <span>2.</span>
  BLS (Boneh–Lynn–Shacham) is a digital signature scheme introduced in 2001. It relies on the hardness of the <a href="https://www.iacr.org/archive/asiacrypt2001/22480516.pdf" style={{textDecoration: 'underline', color: '#018970'}}>Computational Diffie–Hellman (CDH) problem</a> to prevent forgery. A user selects a secret key and derives the corresponding public key on an elliptic curve. To sign, the message is hashed to a curve point and multiplied by the secret key, producing the signature. Verification uses a bilinear pairing to confirm validity. Learn more about BLS signatures <a href="https://www.iacr.org/archive/asiacrypt2001/22480516.pdf" style={{textDecoration: 'underline', color: '#018970'}}>here</a>.
  <a href="#user-content-fnref-2" style={{color: '#6b7280', textDecoration: 'none'}}>↩</a>
</div>
