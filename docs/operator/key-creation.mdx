---
title: Key Creation
sidebar_position: 5
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Admonition from '@theme/Admonition';
import useBaseUrl from '@docusaurus/useBaseUrl';

# Key Creation

After installing the Operator Service, you need to generate validator keystores for your Vault and set up a wallet for handling validator registrations.

The Operator Service provides built-in functionality to generate all of the above.
Alternatively, you may use external tools such as [Wagyu Keygen ‚Üó](https://github.com/stake-house/wagyu-key-gen) to generate keystores, and wallets like [MetaMask ‚Üó](https://metamask.io/) or [MyEtherWallet ‚Üó](https://help.myetherwallet.com/en/articles/6512619-using-mew-offline).

This section walks you through the complete setup process using the Operator Service built-in tools.

<div style={{textAlign: 'center', margin: '2rem 0'}}>
  <pre style={{
    display: 'inline-block',
    textAlign: 'left',
    background: '#FFFFFF4D',
    color: '#018970',
    padding: '2rem',
    borderRadius: '12px',
    fontSize: '14px',
    fontFamily: 'Monaco, monospace',
    boxShadow: '0 10px 30px rgba(1,137,112,0.2)',
    lineHeight: '1.8'
  }}>
    <strong style={{fontSize: '16px', borderBottom: '2px solid #018970', paddingBottom: '0.5rem', display: 'inline-block', marginBottom: '1rem'}}>üîë Key Generation Flow</strong>

     üìù Mnemonic
       ‚îú‚îÄ üîê Validator Keys &rarr; üìÅ Keystores &rarr; ‚úÖ Import to Client
       ‚îî‚îÄ üí≥ Wallet &rarr; üí∞ Fund with ETH &rarr; üöÄ Register Validators
  </pre>
</div>

## Step 1: Initialize Mnemonic

:::custom-notes[Initialize Configuration]
  Run the `init` command to set up your mnemonic used to derive your validator keys.
:::

For example, if running Operator Service from binary:

```bash
./operator init
```

Follow the command prompts.

<details className="custom-details">
<summary>Example Output</summary>

```
Enter the network name (mainnet, hoodi, gnosis, chiado) [mainnet]:
Enter your vault address: 0x3320a...68
Choose your mnemonic language (chinese_simplified, chinese_traditional, czech, english, italian, korean, portuguese, spanish) [english]:
This is your seed phrase. Write it down and store it safely, it is the ONLY way to recover your validator keys.

pumpkin anxiety private salon inquiry ....


Press any key when you have written down your mnemonic.

Please type your mnemonic (separated by spaces) to confirm you have written it down

: pumpkin anxiety private salon inquiry ....

done.
Successfully initialized configuration for vault 0x3320a...68
```

</details>

:::custom-warning[Important Security Notice]
  Keep your mnemonic safe. It is the only way to recover your validator keys.
:::

## Step 2: Generate Validator Keys

Generate validator keystores from your mnemonic using:

```bash
./operator create-keys
```

Follow the command prompts.

<details className="custom-details">
<summary>Example Output</summary>
```
Enter the vault address: 0x3320a...68
Enter the number of the validator keys to generate: 10
Enter the mnemonic for generating the validator keys: pumpkin anxiety private salon inquiry ....
Creating validator keys:    [####################################]  10/10
Generating deposit data JSON    [####################################]  10/10
Exporting validator keystores    [####################################]  10/10

Done. Generated 10 keys for 0x3320a...68 vault.
Keystores saved to /home/user/.stakewise/0x3320a...68/keystores file
Deposit data saved to /home/user/.stakewise/0x3320a...68/keystores/deposit_data.json file
```
</details>

:::custom-notes[Keystore Locations]
  - Keystores are saved to `~/.stakewise/keystores`.
  - The password is stored in `password.txt` within the keystores folder.
:::

:::custom-warning[Important]
  Protect `password.txt` as carefully as your keystores ‚Äî anyone with it can access your keys.
:::

You can always add more validator keys to your Vault. For that, you need to generate new validator keys.

## Step 3: Set Up Wallet

Create a wallet for validator registrations and gas payments:

```bash
./operator create-wallet
```

<details className="custom-details">
<summary>Example Output</summary>
```
Enter the vault address: 0x3320a...68
Enter the mnemonic for generating the wallet: pumpkin anxiety private salon inquiry ...
Done. The wallet and password saved to /home/user/.stakewise/0x3320a...68/wallet directory. The wallet address is: 0x239B...e3Cc
```
</details>

You may reuse the same mnemonic as your validator keys or generate a separate one for added security.

:::custom-warning[Wallet Balance Warning]
  Fund your wallet with ETH (or xDAI on Gnosis) to cover gas:

    - Each validator registration costs ~0.01 ETH at 30 Gwei gas price
    - Check current gas prices at [Etherscan Gas Tracker ‚Üó](https://etherscan.io/gastracker)
    - Monitor balance regularly to prevent registration failures
:::

## Step 4: Import Validator Keys

Upload your keystores into your consensus client:

1. Locate your keystores in `~/.stakewise/keystores`
2. Follow your consensus client's guide for importing keys
3. Use the password from `password.txt` file
4. Set the fee recipient to your Vault's fee recipient address

:::custom-info[Fee Recipient Address]
Found in your Vault's "Details" section on the StakeWise interface.
:::

## Alternative Key Management

Validator keystores don't need to be stored directly in the Operator Service. You can instead use:

- **[Remote Signer ‚Üó](./alternative-key-creation/remote-signer)** - Sign deposit/exit messages via a remote signer
- **[HashiCorp Vault ‚Üó](./alternative-key-creation/hashicorp-vault)** - Load keys from a remote Vault instance
- **[API Mode ‚Üó](./alternative-key-creation/api-mode)** - Run Operator as API service with external key management

## Recover Validator Keystores

You can recover validator keystores that are active. The recovery process will detect validators associated with your Vault address.

:::custom-warning[Safety Requirements]
  Before recovering keystores:
  - **Stop all validators** - Ensure no validators are running with these keystores
  - **Wait at least 2 epochs** - Allow time to pass to avoid slashing
  - **Protect mnemonic** - Your seed phrase can generate all validator keys
:::

```bash
./operator recover
```

<details className="custom-details">
<summary>Example Output</summary>
```
Enter the mnemonic for generating the validator keys: [Your Mnemonic Here]
Enter your vault address: 0x3320ad928c20187602a2b2c04eeaa813fa899468
Enter the comma separated list of API endpoints for execution nodes: https://example.com
Enter the comma separated list of API endpoints for consensus nodes: https://example.com
Enter the network name: hoodi
Found 24 validators, recovering...
Generating keystores [####################################] 100%
Keystores for vault 0x3320ad928c20187602a2b2c04eeaa813fa899468 successfully recovered to /home/user/.stakewise/keystores
```
</details>

## Advanced Configuration

### Environment Variables

Operator Service can be configured via environment variables instead of CLI flags.
Copy [this example file ‚Üó](https://github.com/stakewise/v3-operator/blob/master/.env.example) and save it as `.env`.

```bash
# Load environment variables
export $(grep -v '^#' .env | xargs)

# Verify they're loaded
env
```

### Gas Fee Limits

Protect against excessive gas costs by setting maximum fees:

```bash
./operator start --max-fee-per-gas-wei=100000000000  # 100 Gwei max
```

### CPU Optimization

Reduce CPU load during key operations:

```bash
# Use half your CPU cores (recommended)
./operator create-keys --pool-size=2
```
:::custom-tips[Performance Tip]
  Setting `--pool-size` to half your CPU cores ensures smooth node operation during keystore operations.
:::

## Next Steps

With your keys and wallet prepared, continue to [Getting Started ‚Üó](getting-started) to configure your Vault permissions and launch the Operator Service.

:::custom-info[For consensus client documentation, see:]
[Lighthouse ‚Üó](https://lighthouse-book.sigmaprime.io/intro.html) ‚Ä¢ [Prysm ‚Üó](https://docs.prylabs.network/) ‚Ä¢ [Teku ‚Üó](https://docs.teku.consensys.io/) ‚Ä¢ [Nimbus ‚Üó](https://nimbus.guide/) ‚Ä¢ [Lodestar ‚Üó](https://chainsafe.github.io/lodestar/)
:::
