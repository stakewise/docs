---
title: Installation
sidebar_position: 3
description: "Legacy installation methods for StakeWise V3 Operator Service"
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Admonition from '@theme/Admonition';
import useBaseUrl from '@docusaurus/useBaseUrl';

# Installation

The V3 Operator Service can be installed in several ways: as a binary, via Docker, deployed on Kubernetes with the Operator Helm Chart, or built from source. Choose your preferred method and follow the instructions below.

<Tabs groupId="installation-methods">
  <TabItem value="binary" label="Binary" default>
    ## Binary Installation

    ### Download

    1. Go to the [releases page ↗](https://github.com/stakewise/v3-operator/releases) and find the latest version
    2. Select the binary file for your node's hardware
    3. Download and decompress the file
    4. Run commands from inside the `v3-operator` folder:

    ```bash
    ./operator COMMAND --flagA=123 --flagB=xyz
    ```

    :::custom-notes[Optional Flags]
      The use of flags is optional.
    :::

    ### Install Script (Linux and macOS)

    To install the latest release, run:

    ```bash
    curl -sSfL https://raw.githubusercontent.com/stakewise/v3-operator/master/scripts/install.sh | sh -s
    ```

    The binary will be placed in `~/bin`. Add it to your PATH:

    ```bash
    export PATH=$PATH:~/bin
    ```

    To install a specific version to a custom location:

    ```bash
    curl -sSfL https://raw.githubusercontent.com/stakewise/v3-operator/master/scripts/install.sh | sh -s -- -b <custom_location> vX.X.X
    ```

    Run commands with:

    ```bash
    operator COMMAND --flagA=123 --flagB=xyz
    ```
  </TabItem>
  <TabItem value="docker" label="Docker Image">
    ## Docker Installation

    ### Pull Official Image

    ```bash
    docker pull europe-west4-docker.pkg.dev/stakewiselabs/public/v3-operator:v3.1.5
    ```

    ### Build From Source

    Alternatively, build the Docker image locally:

    ```bash
    git clone https://github.com/stakewise/v3-operator.git
    cd v3-operator
    docker build --pull -t europe-west4-docker.pkg.dev/stakewiselabs/public/v3-operator:v3.1.5 .
    ```

    ### Run Commands

    :::custom-warning[Data Directory Required]
    When running the Operator Service through Docker, it is crucial to use the `--data-dir` flag in all calls. This flag provides a directory path where essential data for the Operator Service is read from or written to, allowing for persistent data storage across Docker container instances.
    :::

    ```bash
    docker run --rm -ti \
    -u $(id -u):$(id -g) \
    -v ~/.stakewise/:/data \
    europe-west4-docker.pkg.dev/stakewiselabs/public/v3-operator:v3.1.5 \
    src/main.py COMMAND \
    --data-dir=/data \
    --flagA=123 \
    --flagB=xyz
    ```

    :::custom-notes[Optional Flags]
      The use of additional flags is optional.
    :::

  </TabItem>
  <TabItem value="source" label="Source Files">
    ## Source Installation

    ### Requirements

    - [Python 3.10+ ↗](https://www.python.org/downloads/)
    - [Poetry ↗](https://python-poetry.org/docs/)

    ### Setup

    Clone the repository and install dependencies:

    ```bash
    git clone https://github.com/stakewise/v3-operator.git
    cd v3-operator
    poetry install --only main
    ```

    ### Run Commands

    Run commands from within the `v3-operator` folder using the below format:

    ```bash
    PYTHONPATH=. poetry run python src/main.py COMMAND --flagA=123 --flagB=xyz
    ```

    :::custom-notes[Optional Flags]
        The use of flags is optional.
    :::
  </TabItem>
  <TabItem value="kubernetes" label="Kubernetes (Advanced)">
    ## Kubernetes Installation

    A dedicated guide is available for running Operator Service on Kubernetes, designed for large-scale validator deployments (up to 10,000 validators). Visit the [Kubernetes setup →](Kubernetes-setup) for more details.

  </TabItem>
</Tabs>

## Configuration Options

### Environment Variables

The V3 Operator Service can be configured via environment variables instead of CLI flags. This approach is particularly useful for containerized deployments.

:::custom-notes[Environment Configuration]
1. Copy the [example file ↗](https://github.com/stakewise/v3-operator/blob/master/.env.example) and save it as `.env`
2. Adjust the configuration based on your node setup
3. Load the environment variables before running the Operator Service:

```bash
export $(grep -v '^#' .env | xargs)
```

Verify variables are loaded correctly by running `env`.
:::

### Performance Optimization

:::custom-info[CPU Load Management]
Use the `--pool-size` flag with both `start` and `create-keys` commands to control CPU usage:

- **Default**: Uses 100% of available CPU cores
- **Recommended**: Set to `(number of CPU cores) / 2` to avoid impacting node performance
- **Example**: `--pool-size=4` for an 8-core system

```bash
./operator start --pool-size=4 --vault=0x000...
```
:::

### Gas Fee Management

:::custom-warning[Gas Cost Control]
To mitigate excessive gas costs, use the `--max-fee-per-gas-wei` flag when starting the Operator Service:

```bash
./operator start --max-fee-per-gas-wei=50000000000 --vault=0x000...
```

This sets the maximum base fee you're willing to pay for validator registrations and vault harvests.
:::

## Verification

After installation, verify your setup by running the version command:

<Tabs groupId="installation-methods">
  <TabItem value="binary" label="Binary">
    ```bash
    ./operator --version
    ```
  </TabItem>
  <TabItem value="docker" label="Docker">
    ```bash
    docker run --rm europe-west4-docker.pkg.dev/stakewiselabs/public/v3-operator:v3.1.5 src/main.py --version
    ```
  </TabItem>
  <TabItem value="source" label="Source">
    ```bash
    PYTHONPATH=. poetry run python src/main.py --version
    ```
  </TabItem>
</Tabs>

## Troubleshooting

### Common Issues

:::custom-warning[Permission Issues]
If you encounter permission errors:
- Ensure the binary is executable: `chmod +x ./operator`
- For Docker: Verify user ID mapping with `-u $(id -u):$(id -g)`
- For source installs: Check Python and Poetry permissions
:::

:::custom-info[Network Connectivity]
If the installation fails to download dependencies:
- Check firewall and proxy settings
- Verify internet connectivity to GitHub and package repositories
- For Docker: Ensure Docker daemon is running and has internet access
:::

### Support

For installation issues:
- Check the [GitHub Issues ↗](https://github.com/stakewise/v3-operator/issues)
- Review the troubleshooting documentation
- Contact the StakeWise team via Discord or Telegram

---

Installation complete! Next, proceed with [V3 Operator setup and configuration](./operator-v3-overview).
